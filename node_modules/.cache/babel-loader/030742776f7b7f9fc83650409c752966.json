{"ast":null,"code":"import _slicedToArray from\"/home/javier.sosa/Escritorio/JS PROJECTS/whatsapp-clone/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{Avatar}from\"@material-ui/core\";import db from\"./firebase\";import{onSnapshot,collection,query,orderBy,addDoc}from\"./firebase\";import{Link}from\"react-router-dom\";import'./SidebarChat.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function SidebarChat(_ref){var _messages$;var id=_ref.id,name=_ref.name,addNewChat=_ref.addNewChat;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),seed=_useState2[0],setSeed=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),messages=_useState4[0],setMessages=_useState4[1];useEffect(function(){if(id){var messagesCollection=query(collection(db,\"rooms\",\"\".concat(id),\"messages\"),orderBy(\"timestamp\",\"desc\"));onSnapshot(messagesCollection,function(snapshot){setMessages(snapshot.docs.map(function(doc){return doc.data();}));});}},[id]);useEffect(function(){setSeed(Math.floor(Math.random()*5000));},[]);var createChat=function createChat(){var roomName=prompt(\"Please enter name for chat room\");if(roomName){addDoc(collection(db,\"rooms\"),{name:roomName});}};return!addNewChat?/*#__PURE__*/_jsx(Link,{to:\"/rooms/\".concat(id),children:/*#__PURE__*/_jsxs(\"div\",{className:\"sidebarChat\",children:[/*#__PURE__*/_jsx(Avatar,{src:\"https://avatars.dicebear.com/api/human/\".concat(seed,\".svg\")}),/*#__PURE__*/_jsxs(\"div\",{className:\"sidebarChat__info\",children:[/*#__PURE__*/_jsx(\"h2\",{children:name}),/*#__PURE__*/_jsx(\"p\",{children:(_messages$=messages[0])===null||_messages$===void 0?void 0:_messages$.message})]})]})}):/*#__PURE__*/_jsx(\"div\",{onClick:createChat,className:\"sidebarChat\",children:/*#__PURE__*/_jsx(\"h2\",{children:\"Add new chat\"})});}export default SidebarChat;","map":{"version":3,"sources":["/home/javier.sosa/Escritorio/JS PROJECTS/whatsapp-clone/src/SidebarChat.js"],"names":["React","useEffect","useState","Avatar","db","onSnapshot","collection","query","orderBy","addDoc","Link","SidebarChat","id","name","addNewChat","seed","setSeed","messages","setMessages","messagesCollection","snapshot","docs","map","doc","data","Math","floor","random","createChat","roomName","prompt","message"],"mappings":"8KAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,OAASC,MAAT,KAAuB,mBAAvB,CACA,MAAOC,CAAAA,EAAP,KAAe,YAAf,CACA,OAASC,UAAT,CAAqBC,UAArB,CAAiCC,KAAjC,CAAwCC,OAAxC,CAAiDC,MAAjD,KAA+D,YAA/D,CACA,OAASC,IAAT,KAAqB,kBAArB,CACA,MAAO,mBAAP,C,wFAIA,QAASC,CAAAA,WAAT,MAA+C,mBAAxBC,CAAAA,EAAwB,MAAxBA,EAAwB,CAApBC,IAAoB,MAApBA,IAAoB,CAAdC,UAAc,MAAdA,UAAc,CAC3C,cAAwBZ,QAAQ,CAAC,EAAD,CAAhC,wCAAOa,IAAP,eAAaC,OAAb,eACA,eAAgCd,QAAQ,CAAC,EAAD,CAAxC,yCAAOe,QAAP,eAAiBC,WAAjB,eAEAjB,SAAS,CAAC,UAAK,CACX,GAAIW,EAAJ,CAAQ,CACJ,GAAMO,CAAAA,kBAAkB,CAAGZ,KAAK,CAACD,UAAU,CAACF,EAAD,CAAK,OAAL,WAAiBQ,EAAjB,EAAuB,UAAvB,CAAX,CAA+CJ,OAAO,CAAC,WAAD,CAAc,MAAd,CAAtD,CAAhC,CACAH,UAAU,CAACc,kBAAD,CAAqB,SAACC,QAAD,CAAc,CACzCF,WAAW,CAACE,QAAQ,CAACC,IAAT,CAAcC,GAAd,CAAkB,SAACC,GAAD,QAC1BA,CAAAA,GAAG,CAACC,IAAJ,EAD0B,EAAlB,CAAD,CAAX,CAGH,CAJS,CAAV,CAKH,CACJ,CATQ,CASN,CAACZ,EAAD,CATM,CAAT,CAWAX,SAAS,CAAC,UAAM,CACZe,OAAO,CAACS,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,GAAgB,IAA3B,CAAD,CAAP,CACH,CAFQ,CAEN,EAFM,CAAT,CAIA,GAAMC,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAM,CACrB,GAAMC,CAAAA,QAAQ,CAAGC,MAAM,CAAC,iCAAD,CAAvB,CAEA,GAAID,QAAJ,CAAc,CACVpB,MAAM,CAACH,UAAU,CAACF,EAAD,CAAK,OAAL,CAAX,CAA0B,CAC5BS,IAAI,CAAEgB,QADsB,CAA1B,CAAN,CAGH,CACJ,CARD,CAUA,MAAO,CAACf,UAAD,cACH,KAAC,IAAD,EAAM,EAAE,kBAAYF,EAAZ,CAAR,uBACI,aAAK,SAAS,CAAC,aAAf,wBACI,KAAC,MAAD,EAAQ,GAAG,kDAA4CG,IAA5C,QAAX,EADJ,cAEI,aAAK,SAAS,CAAC,mBAAf,wBACI,oBAAKF,IAAL,EADJ,cAEI,+BAAII,QAAQ,CAAC,CAAD,CAAZ,qCAAI,WAAac,OAAjB,EAFJ,GAFJ,GADJ,EADG,cAYH,YAAK,OAAO,CAAEH,UAAd,CAA0B,SAAS,CAAC,aAApC,uBACI,oCADJ,EAZJ,CAgBH,CAED,cAAejB,CAAAA,WAAf","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { Avatar } from \"@material-ui/core\";\nimport db from \"./firebase\";\nimport { onSnapshot, collection, query, orderBy, addDoc } from \"./firebase\";\nimport { Link } from \"react-router-dom\";\nimport './SidebarChat.css';\n\n\n\nfunction SidebarChat({ id, name, addNewChat }) {\n    const [seed, setSeed] = useState(\"\");\n    const [messages, setMessages] = useState([]);\n\n    useEffect(() =>{\n        if (id) {\n            const messagesCollection = query(collection(db, \"rooms\", `${id}`, \"messages\"), orderBy(\"timestamp\", \"desc\"));\n            onSnapshot(messagesCollection, (snapshot) => {\n                setMessages(snapshot.docs.map((doc) => \n                    doc.data()\n                ))\n            });\n        }\n    }, [id]);\n\n    useEffect(() => {\n        setSeed(Math.floor(Math.random() * 5000));\n    }, []);\n\n    const createChat = () => {\n        const roomName = prompt(\"Please enter name for chat room\");\n\n        if (roomName) {\n            addDoc(collection(db, \"rooms\"), {\n                name: roomName\n            });\n        }\n    };\n\n    return !addNewChat ? (\n        <Link to={`/rooms/${id}`}>\n            <div className=\"sidebarChat\">\n                <Avatar src={`https://avatars.dicebear.com/api/human/${seed}.svg`} />\n                <div className=\"sidebarChat__info\">\n                    <h2>{name}</h2>\n                    <p>{messages[0]?.message}</p>\n                </div>\n            </div>\n        </Link>\n        \n    ): (\n        <div onClick={createChat} className=\"sidebarChat\">\n            <h2>Add new chat</h2>\n        </div>\n    );\n}\n\nexport default SidebarChat\n"]},"metadata":{},"sourceType":"module"}